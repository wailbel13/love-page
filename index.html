<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>3youuuuuuuuniii ğŸ˜­ğŸ’•</title>

  <style>
    :root{
      --bg1:#fff7fb; --bg2:#ffe7f2; --card:#ffffffcc; --txt:#1f1f1f;
      --accent:#ff2f88; --accent2:#ff6aa8; --shadow:0 14px 40px rgba(0,0,0,.10);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,"Segoe UI",Tahoma,Arial;
      color:var(--txt);
      background:
        radial-gradient(900px 500px at 15% 0%, var(--bg2), transparent 60%),
        radial-gradient(900px 500px at 85% 20%, #ffe0ee, transparent 60%),
        linear-gradient(180deg, var(--bg1), #fff);
      min-height:100vh;
    }
    a{color:inherit}
    .wrap{max-width:980px;margin:0 auto;padding:18px 14px 54px}
    .top{text-align:center;padding:24px 14px 10px;position:relative}
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      background:linear-gradient(135deg,#ffe2f0,#fff);
      border:1px solid rgba(255,47,136,.18);
      padding:9px 12px; border-radius:999px;
      font-size:13px; opacity:.95;
    }
    .hero{
      width:98px; height:98px; margin:0 auto 12px;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      border-radius:24px;
      display:grid; place-items:center;
      box-shadow:var(--shadow);
      transform:rotate(6deg);
    }
    .hero span{font-size:48px; transform:rotate(-6deg)}
    h1{margin:8px 0 8px; font-size:34px}
    .sub{opacity:.88; font-size:15.5px; line-height:1.85; max-width:820px; margin:0 auto}
    .grid{display:grid; gap:14px; grid-template-columns:1fr}
    @media(min-width:920px){ .grid{grid-template-columns:1fr 1fr} .span2{grid-column:span 2} }
    .card{
      background:var(--card);
      border:1px solid rgba(255,47,136,.12);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      backdrop-filter:blur(8px);
    }
    .card h2{margin:0 0 10px; font-size:18px}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .btn{
      border:0; cursor:pointer;
      padding:12px 14px;
      border-radius:14px;
      font-weight:800;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      color:#fff;
      box-shadow:0 10px 18px rgba(255,47,136,.22);
    }
    .btn.secondary{
      background:#fff; color:var(--accent);
      border:1px solid rgba(255,47,136,.28);
      box-shadow:none;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      background:linear-gradient(135deg,#ffe2f0,#fff);
      border:1px solid rgba(255,47,136,.18);
      padding:8px 12px; border-radius:999px; font-size:13px;
    }
    .stat{
      flex:1; min-width:140px;
      background:#fff;
      border:1px solid rgba(0,0,0,.06);
      padding:12px;
      border-radius:14px;
    }
    .stat b{display:block; font-size:20px}
    input,textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(0,0,0,.12);
      outline:none;
      font-size:15px;
      background:#fff;
    }
    textarea{min-height:170px; resize:vertical; line-height:1.8; white-space:pre-line}
    .small{opacity:.75; font-size:13px; line-height:1.7}

    .songs a{
      display:flex; justify-content:space-between; gap:10px; align-items:center;
      padding:11px 12px; border-radius:14px; text-decoration:none; color:inherit;
      background:#fff; border:1px solid rgba(0,0,0,.06);
      margin-bottom:8px;
    }
    .songs a small{opacity:.65}

    .loveGrid{display:grid; gap:10px; grid-template-columns:1fr}
    @media(min-width:920px){ .loveGrid{grid-template-columns:1fr 1fr} }
    .loveItem{
      background:#fff;
      border:1px solid rgba(0,0,0,.06);
      border-radius:16px;
      padding:12px;
      display:flex; gap:10px; align-items:flex-start;
    }
    .loveEmoji{
      width:42px; height:42px;
      border-radius:14px;
      display:grid; place-items:center;
      background:linear-gradient(135deg,#ffe2f0,#fff);
      border:1px solid rgba(255,47,136,.18);
      font-size:22px;
      flex:0 0 auto;
    }
    .scratchWrap{background:#fff;border:1px solid rgba(0,0,0,.06);border-radius:18px;overflow:hidden}
    .scratchTop{padding:12px 12px 0}
    .scratchTop h3{margin:0 0 6px; font-size:16px}
    .scratchTop p{margin:0 0 12px; opacity:.78; font-size:13px; line-height:1.7}
    .scratchStage{position:relative; width:100%; aspect-ratio:16/10; max-height:380px}
    .scratchStage img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover}
    .scratchStage canvas{position:absolute; inset:0; width:100%; height:100%}

    .moonBox{
      display:flex; gap:12px; align-items:center; flex-wrap:wrap;
      background:#fff; border:1px solid rgba(0,0,0,.06);
      border-radius:16px; padding:12px;
    }
    .moon{
      width:74px; height:74px; border-radius:50%;
      background:radial-gradient(circle at 35% 35%, #fff, #eaeaea 60%, #d8d8d8 100%);
      position:relative; overflow:hidden; border:1px solid rgba(0,0,0,.06);
    }
    .moonShadow{position:absolute; inset:-10px; background:#111; border-radius:50%; opacity:.92; mix-blend-mode:multiply}
    .moonMeta b{display:block; font-size:16px}
    .moonMeta span{opacity:.72; font-size:13px}

    .wheelWrap{
      background:#fff; border:1px solid rgba(0,0,0,.06);
      border-radius:18px; padding:12px;
      display:grid; gap:10px; place-items:center;
    }
    .wheelStage{position:relative; width:min(360px, 92vw); aspect-ratio:1/1}
    #wheel{width:100%; height:100%}
    .pointer{
      position:absolute; top:-6px; left:50%; transform:translateX(-50%);
      width:0;height:0;
      border-left:14px solid transparent;
      border-right:14px solid transparent;
      border-bottom:22px solid var(--accent);
      filter:drop-shadow(0 6px 10px rgba(0,0,0,.18));
    }
    .result{
      margin-top:6px;
      background:linear-gradient(135deg,#ffe2f0,#fff);
      border:1px solid rgba(255,47,136,.18);
      padding:10px 12px;
      border-radius:14px;
      width:100%;
      text-align:center;
      font-weight:800;
      color:#222;
    }

    .envWrap{display:grid; gap:10px}
    .envHint{opacity:.75; font-size:13px; margin:0}
    .envelope{
      position:relative;
      width:100%;
      max-width:720px;
      margin:0 auto;
      border-radius:18px;
      overflow:hidden;
      cursor:pointer;
      box-shadow:var(--shadow);
      border:1px solid rgba(255,47,136,.16);
      background:#fff;
    }
    .envTop{
      padding:14px 14px 12px;
      background:linear-gradient(135deg, rgba(255,47,136,.10), rgba(255,106,168,.10));
      display:flex; justify-content:space-between; align-items:center; gap:10px;
    }
    .envTop b{font-size:15px}
    .envTop span{opacity:.75; font-size:13px}
    .envBody{padding:0; max-height:0; overflow:hidden; transition:max-height .5s ease; background:#fff}
    .envBody.open{max-height:900px}
    .envLetter{padding:14px; white-space:pre-line; line-height:1.9; color:#222}

    .confetti{position:fixed; inset:0; pointer-events:none; overflow:hidden}
    .c{position:absolute; font-size:18px; will-change:transform; opacity:.95}

    .footer{ text-align:center; margin-top:16px; opacity:.75; font-size:13px }

    /* =========================
       ğŸ”’ LOCK SCREEN
       ========================= */
    .lock{
      position:fixed; inset:0; z-index:9999;
      display:grid; place-items:center;
      background:
        radial-gradient(900px 600px at 30% 10%, rgba(255,47,136,.18), transparent 60%),
        radial-gradient(900px 600px at 80% 30%, rgba(255,106,168,.18), transparent 60%),
        linear-gradient(180deg, #fff7fb, #fff);
      overflow:hidden;
    }
    .lockHearts{position:absolute; inset:0; pointer-events:none; overflow:hidden}
    .h{
      position:absolute;
      font-size:22px;
      opacity:.22;
      animation: float 10s linear infinite;
      filter: blur(.1px);
    }
    @keyframes float{
      from{transform:translateY(110vh) rotate(0deg)}
      to{transform:translateY(-20vh) rotate(360deg)}
    }
    .lockCard{
      width:min(520px, 92vw);
      border-radius:22px;
      padding:18px;
      background:rgba(255,255,255,.82);
      backdrop-filter: blur(10px);
      border:1px solid rgba(255,47,136,.16);
      box-shadow: var(--shadow);
      text-align:center;
      position:relative;
    }
    .lockIcon{
      width:86px; height:86px; margin:0 auto 10px;
      border-radius:22px;
      display:grid; place-items:center;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      color:#fff;
      box-shadow:0 12px 22px rgba(255,47,136,.22);
      transform: rotate(6deg);
    }
    .lockIcon span{font-size:40px; transform:rotate(-6deg)}
    .lockTitle{margin:8px 0 6px; font-size:26px}
    .lockSub{margin:0 auto 14px; opacity:.82; line-height:1.8; max-width:430px; font-size:14px}
    .lockRow{display:flex; gap:10px; flex-wrap:wrap; justify-content:center}
    .lockInput{
      width:min(340px, 86vw);
      text-align:center;
      font-weight:800;
      letter-spacing:.5px;
    }
    .hint{opacity:.7; font-size:12px; margin-top:10px}
    .shake{animation: shake .35s ease}
    @keyframes shake{
      0%,100%{transform:translateX(0)}
      25%{transform:translateX(10px)}
      50%{transform:translateX(-10px)}
      75%{transform:translateX(8px)}
    }
  </style>
</head>

<body>

  <!-- ğŸ”’ Lock screen overlay -->
  <div class="lock" id="lock">
    <div class="lockHearts" id="lockHearts"></div>

    <div class="lockCard" id="lockCard">
      <div class="lockIcon"><span>ğŸ’—</span></div>
      <div class="lockTitle">Ù…Ø±ÙˆÙ‰â€¦ Ù‡Ø°ÙŠ Ù„ÙŠÙƒ ÙˆØ­Ø¯Ùƒ ğŸ¤</div>
      <div class="lockSub">
        Ø¨Ø§Ø´ ØªØ¯Ø®Ù„ÙŠ Ù„Ù„ØµÙØ­Ø©ØŒ Ø§ÙƒØªØ¨ÙŠ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±â€¦ (Ù‡ÙŠ ØªØ§Ø±ÙŠØ® Ù†Ù‡Ø§Ø± Ø¯Ø®Ù„ØªÙŠ Ø­ÙŠØ§ØªÙŠ) ğŸ¥¹
      </div>

      <div class="lockRow">
        <input class="lockInput" id="pass" placeholder="Ø§ÙƒØªØ¨ÙŠ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù‡Ù†Ø§â€¦" inputmode="numeric" />
        <button class="btn" id="enter">Ø¯Ø®ÙˆÙ„ â¤ï¸</button>
      </div>

      
    </div>
  </div>

  <!-- âœ… Main page -->
  <div class="wrap" id="content" style="display:none">
    <header class="top">
      <div class="hero"><span>â¤ï¸</span></div>
      <h1 id="pageTitle">Ù…Ø±ÙˆÙ‰ Ø¹ÙŠÙˆÙ†ÙŠ â¤ï¸</h1>

      <p class="sub" id="pageSub">
Ù…Ø±ÙˆÙ‰ Ø¹ÙŠÙˆÙ†ÙŠ â¤ï¸ Ø§Ù„ÙŠÙˆÙ… Ø¹ÙŠØ¯ Ø§Ù„Ø­Ø¨â€¦ Ø¨ØµØ­ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„ÙŠØ§ ÙƒÙ„ Ù†Ù‡Ø§Ø± Ù…Ø¹Ø§Ùƒ Ù‡Ùˆ Ø¹ÙŠØ¯. Ù…Ù† Ù†Ù‡Ø§Ø± Ø¯Ø®Ù„ØªÙŠ Ø­ÙŠØ§ØªÙŠ ØªØ¨Ø¯Ù„Øª Ø§Ù„Ø¯Ù†ÙŠØ§ ÙÙŠ Ø¹ÙŠÙ†ÙŠâ€¦ ÙˆÙ„ÙŠØª Ù†Ø´ÙˆÙÙ‡Ø§ Ø¨Ø£Ù„ÙˆØ§Ù† Ø£Ø®Ø±Ù‰. Ù†Ø¹ÙŠØ·Ù„Ùƒ Ø¹ÙŠÙˆÙ†ÙŠ ÙˆÙ…Ø§Ø´ÙŠ ØºÙŠØ± ÙƒÙ„Ø§Ù…â€¦ Ø¨ØµØ­ Ù„Ø£Ù†Ùƒ ÙØ¹Ù„Ø§Ù‹ Ù†ÙˆØ± Ø¹ÙŠÙ†ÙŠ ÙˆØ±Ø§Ø­Ø© Ù‚Ù„Ø¨ÙŠ. ÙˆØ¹Ø¯ Ø±Ø¬Ø§Ù„ Ù‚Ø¯Ø§Ù… Ø±Ø¨ÙŠ ÙˆÙ‚Ø¯Ø§Ù… Ù‚Ù„Ø¨ÙŠâ€¦ ÙŠØ¬ÙŠ Ù†Ù‡Ø§Ø± ÙˆÙ†Ù„Ø¨Ø³Ùƒ Ø®Ø§ØªÙ… Ø¹Ù„Ù‰ Ø³Ù†Ø© Ø§Ù„Ù„Ù‡ ÙˆØ±Ø³ÙˆÙ„Ùˆ Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ ğŸ¤ ÙˆÙ†Ø¨Ù‚Ø§Ùˆ Ù…Ø¹ Ø¨Ø¹Ø¶Ù†Ø§ Ø§Ù„Ø¹Ù…Ø± ÙƒØ§Ù…Ù„. ÙƒÙ„ Ø«Ø§Ù†ÙŠØ© ØªÙÙˆØª Ù…Ø¹Ø§Ùƒ Ù†Ø­Ø³Ø¨Ù‡Ø§ Ù†Ø¹Ù…Ø©â€¦ ÙˆÙ‡Ø§Ø¯ Ø§Ù„Ø¹Ø¯Ø§Ø¯ ØºÙŠØ± ÙŠØ°ÙƒØ±Ù†ÙŠ Ø¨Ù„ÙŠ Ø±Ø§Ù†ÙŠ Ù†Ø¹ÙŠØ´ Ø£Ø¬Ù…Ù„ Ø£ÙŠØ§Ù… Ø­ÙŠØ§ØªÙŠ Ù…Ø¹Ø§Ùƒ â¤ï¸
      </p>

      <div class="row" style="justify-content:center; margin-top:12px">
        <span class="badge">âœ¨ Love Palette</span>
        <button class="btn secondary" id="copyBtn">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
      </div>
    </header>

    <div class="grid">

      <section class="card">
        <h2>Ù…Ù† Ù†Ù‡Ø§Ø± Ø¯Ø®Ù„ØªÙŠ Ø­ÙŠØ§ØªÙŠ â³â¤ï¸</h2>
        <p class="small">Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙŠØ¨Ø¯Ø£ Ù…Ù† Ø§Ù„ØªØ§Ø±ÙŠØ® Ù„ÙŠ ØªØ­Øª: <b>18/07/2025</b></p>

        <div class="row">
          <div class="stat"><span>Ø£ÙŠØ§Ù…</span><b id="dDays">0</b></div>
          <div class="stat"><span>Ø³Ø§Ø¹Ø§Øª</span><b id="dHours">0</b></div>
          <div class="stat"><span>Ø¯Ù‚Ø§Ø¦Ù‚</span><b id="dMins">0</b></div>
          <div class="stat"><span>Ø«ÙˆØ§Ù†ÙŠ</span><b id="dSecs">0</b></div>
        </div>

        <div class="row" style="margin-top:10px">
          <span class="pill">Start Date: <b id="sinceLabel">2025-07-18</b></span>
        </div>
      </section>

      <section class="card">
        <h2>Ø¨Ø³Ù…Ø© Ù…Ù†Ùƒ ØªÙƒÙÙŠÙ†ÙŠ ğŸ¤</h2>
        <p class="small">Ø§Ø¶ØºØ·ÙŠ Ø§Ù„Ø²Ø±â€¦ ÙˆØ±Ø§Ø­ â€œÙŠÙØ±Ù‚Ø¹â€ Ù‚Ù„ÙˆØ¨ â¤ï¸ğŸ’–ğŸ’˜</p>
        <div class="row">
          <button class="btn" id="partyBtn">Ø§Ø­ØªÙØ§Ù„ â¤ï¸â€ğŸ”¥</button>
          <span class="pill">Hearts: â¤ï¸ ğŸ’– ğŸ’˜</span>
        </div>
      </section>

      <section class="card span2">
        <h2>Ø­ÙƒÙŠ Ù‡Ù†Ø§ ÙŠØ§ Ø¹ÙŠÙˆÙ†ÙŠ ğŸ‘€ğŸ’</h2>
        <div class="scratchWrap">
          <div class="scratchTop">
            <h3>Ø§Ø¬Ù…Ù„ Ù…Ø§ Ø´Ø§ÙØª Ø¹ÙŠÙ†ÙŠ ğŸ«£ğŸ’•</h3>
            <p>Ø­ÙƒÙŠ/Ø§Ù…Ø³Ø­ÙŠ ÙÙˆÙ‚ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ø´ ØªØ¨Ø§Ù† ğŸ’—</p>
          </div>

          <div class="scratchStage">
            <img id="hiddenImg" src="marwa.jpg" alt="hidden" />
            <canvas id="scratch"></canvas>
          </div>

          <div style="padding:12px">
            <b>ÙƒÙ„ ØªÙØµÙŠÙ„Ø© ÙÙŠÙƒ ØªØ¹Ù†ÙŠÙ†ÙŠ ğŸ¥¹</b>
            <div class="small">ÙƒÙ„ Ø­Ø§Ø¬Ø© ØµØºÙŠØ±Ø© ÙÙŠÙƒ ØªØ®Ù„ÙŠÙ†ÙŠ Ù†Ø­Ø¨Ùƒ Ø£ÙƒØ«Ø± ğŸ¤</div>
          </div>
        </div>
        <div class="small" style="margin-top:8px">
        </div>
      </section>

      <section class="card span2">
        <h2>Ø­Ø§Ø¬Ø§Øª Ù†Ø­Ø¨Ù‡Ù… ÙÙŠÙƒ ğŸ’</h2>
        <div class="loveGrid" id="loveGrid"></div>
      </section>

      <section class="card">
        <h2>Ù„ÙŠÙ„Ø© Ù…Ø§ ØªØªÙ†Ø³Ø§Ø´ Ø¨ÙŠÙ†ÙŠ ÙˆØ¨ÙŠÙ†Ùƒ ğŸŒ™</h2>
        <p class="small">ÙƒØ§Ù† Ù‚Ù…Ø± Ø¹Ø§Ø¯ÙŠ Ù„Ù„Ù†Ø§Ø³ ... Ø¨ØµØ­ Ù„ÙŠØ§ ÙƒØ§Ù† Ø¨Ø¯Ø§ÙŠØ© Ø­ÙŠØ§Ø©</p>

        <div class="moonBox">
          <div class="moon"><div class="moonShadow" id="moonShadow"></div></div>
          <div class="moonMeta">
            <b id="moonName">â€”</b>
            <span id="moonPct">â€”</span><br>
            <span>01/01/2026</span>
          </div>
        </div>

        <div class="row" style="margin-top:10px">
          <span class="pill">Show Phase Name âœ…</span>
          <span class="pill">Show % âœ…</span>
        </div>
      </section>

      <section class="card">
        <h2>Compatibility Calculator ğŸ’</h2>

        <div class="row" style="margin-bottom:10px">
          <div style="flex:1; min-width:220px">
            <label class="small"> Ø§Ø³Ù…Ùƒ </label>
            <input id="name1" value="ÙˆØ§Ø¦Ù„ğŸ’•" />
          </div>
          <div style="flex:1; min-width:220px">
            <label class="small">Ø§Ø³Ù…Ù‡Ø§</label>
            <input id="name2" value="Ù…Ø±ÙˆÙ‰" />
          </div>
        </div>

        <div class="row">
          <button class="btn" id="calcBtn">Ø§Ø­Ø³Ø¨ â¤ï¸</button>
          <span class="pill">Ø§Ù„Ù†ØªÙŠØ¬Ø©: <b id="score">â€”</b>%</span>
        </div>
        <p id="scoreMsg" class="small" style="margin-top:10px"></p>
      </section>

      <section class="card span2">
        <h2>Ø¬Ø±Ø¨ÙŠ Ø­Ø¸Ùƒ ÙŠØ§ Ø¹ÙŠÙˆÙ†ÙŠ â¤ï¸</h2>
        <p class="small">Ø¥Ø°Ø§ Ø±Ø¨Ø­ØªÙŠ: <b>Ù…ÙØ§Ø¬Ø£Ø© Ù…Ù† Ù‚Ù„Ø¨ÙŠ Ù„ÙŠÙƒ ğŸğŸ¤</b></p>

        <div class="wheelWrap">
          <div class="wheelStage">
            <div class="pointer"></div>
            <canvas id="wheel" width="900" height="900"></canvas>
          </div>
          <button class="btn" id="spinBtn">Ø§Ø¶ØºØ·ÙŠ Ù‡Ù†Ø§ ÙŠØ§ Ø¹ÙŠÙˆÙ†ÙŠ ğŸ¡</button>
          <div class="result" id="wheelResult">â€”</div>
        </div>
      </section>

      <section class="card span2">
        <h2>Ø§Ù„Ø£ØºØ§Ù†ÙŠ Ù„ÙŠ ØªØ°ÙƒØ±Ù†ÙŠ Ø¨ÙŠÙƒ ğŸ§ğŸ¤</h2>
        <div class="songs" id="songs"></div>
      </section>

      <section class="card span2">
        <h2>Letter ğŸ’Œ</h2>
        <div class="envWrap">
          <p class="envHint">Ø§Ø¶ØºØ·ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¸Ø±Ù Ø¨Ø§Ø´ ÙŠØªØ­Ù„ âœ¨</p>

          <div class="envelope" id="envelope">
            <div class="envTop">
              <b>Ø±Ø³Ø§Ù„Ø© Ù…Ù† ÙˆØ§Ø¦Ù„ ğŸ’</b>
              <span>Ø§Ø¶ØºØ·ÙŠ Ù‡Ù†Ø§â€¦</span>
            </div>
            <div class="envBody" id="envBody">
              <div class="envLetter" id="letterText"></div>
            </div>
          </div>

          <div class="row">
            <button class="btn secondary" id="copyLetter">Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø©</button>
          </div>
        </div>
      </section>

    </div>

    <div class="footer">ØµÙ†Ø¹ØªÙ‡Ø§ Ø¨Ø­Ø¨ â¤ï¸ â€” ÙˆØ§Ø¦Ù„</div>
  </div>

  <div class="confetti" id="confetti"></div>

<script>
/* =========================
   âœ… Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªÙƒ
   ========================= */
const PASSWORD = "18-07-2025"; // ğŸ”¥ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±

const CONFIG = {
  sinceDate: "2025-07-18",
  moonDate: "2026-01-01",

  loveItems: [
    {emoji:"â¤ï¸", title:"Ù†Ø­Ø¨ Ø¶Ø­ÙƒØªÙƒ Ù„ÙŠ ØªØ±Ø¯Ù„ÙŠ Ø±ÙˆØ­ÙŠ â¤ï¸"},
    {emoji:"ğŸ’‹", title:"Ù†Ø­Ø¨ ÙƒÙŠ ØªØ¹ÙŠØ·ÙŠÙ„ÙŠ ØµØ¨Ø§Ø­Ùˆ Ø¹ÙŠÙˆÙ†ÙŠğŸ˜­"},
    {emoji:"ğŸ’˜", title:"Ù†Ø­Ø¨ ÙƒÙŠ ØªØªÙÙƒØ±ÙŠÙ†ÙŠ ÙŠØ§Ùˆ Ù„ÙˆÙƒØ§Ù† Ø¨Ø­Ø§Ø¬Ø© ØµØºÙŠØ±Ø© ğŸ«£"},
    {emoji:"âœ¨", title:"Ù†Ø­Ø¨ ÙƒÙŠ ØªÙ‚ÙˆÙ„ÙŠÙ„ÙŠ Ø±Ø¯ Ø¨Ø§Ù„Ùƒ Ø¹Ù„Ù‰ Ø±ÙˆØ­Ùƒ ğŸ’"},
    {emoji:"ğŸ’“", title:"Ù†Ø­Ø¨ Ø·Ù…ÙˆØ­Ùƒ ÙˆÙ†Ø´ÙˆÙÙƒ Ø¯Ø§ÙŠÙ…Ø§Ù‹ Ù‚Ø¯Ø§Ù…ÙŠ Ù†Ø§Ø¬Ø­Ø© âœ¨"},
    {emoji:"ğŸ˜˜", title:"Ù†Ø­Ø¨ ÙƒÙŠ Ù†ÙƒÙˆÙ† Ù…Ø¶Ø§ÙŠÙ‚ ÙˆÙ†Ø³Ù…Ø¹ ØµÙˆØªÙƒ Ù†Ù‡Ø¯Ù‰ ğŸ¤"},
    {emoji:"ğŸŒ¹", title:"Ù†Ø­Ø¨ Ø«Ù‚ØªÙƒ ÙÙŠØ§ ÙƒÙŠÙ…Ø§ Ø£Ù†Ø§ Ù†Ø«Ù‚ ÙÙŠÙƒ ğŸ’"},
    {emoji:"ğŸ˜", title:"Ù†Ø­Ø¨ Ø·Ø±ÙŠÙ‚ØªÙƒ ÙƒÙŠ ØªÙØ±Ø­ÙŠ Ø¹Ù„Ù‰ Ø­Ø§Ø¬Ø§Øª ØµØºÙŠØ±Ø© ğŸ¥¹"},
    {emoji:"ğŸ’–", title:"Ù†Ø­Ø¨ ØµØ¨Ø±Ùƒ Ù…Ø¹Ø§ÙŠØ§ Ø­ØªÙ‰ ÙÙŠ Ø£ØµØ¹Ø¨ Ù„Ø­Ø¸Ø§ØªÙŠ ğŸ’˜"},
    {emoji:"ğŸ’", title:"Ù†Ø­Ø¨Ùƒ Ù„Ø£Ù†Ùƒ Ø¨Ø¨Ø³Ø§Ø·Ø©â€¦ Ù†ØªÙŠ ğŸ’"},
  ],

  prizes: [
    "Ù…ÙØ§Ø¬Ø£Ø© ØµØºÙŠØ±Ø© Ù†ÙˆØµÙ„Ù‡Ø§ Ù„Ø¯Ø§Ø±ÙƒÙ… ğŸ",
    "ÙˆØ¹Ø¯ Ø¬Ø¯ÙŠØ¯ Ù…Ù†ÙŠ Ù„ÙŠÙƒ ğŸ’",
    "ØªØ·Ù„Ø¨ÙŠ Ø§ÙŠ Ø­Ø§Ø¬Ø© Ù…Ù†ÙŠ Ù†ØªÙŠ Ø­Ø§Ø¨ØªÙ†ÙŠ Ù†Ø¯ÙŠØ±Ù‡Ø§ğŸ«£",
    "Ù†Ø­Ø· Ø§ØºÙ†ÙŠØ© Ù…Ù† Ø§Ø®ØªÙŠØ§Ø±Ùƒ Ù noteâœ¨",
    "Ù†Ø¹ÙŠØ·Ù„Ùƒ Ù†Ù‚ÙˆÙ„Ùƒ Ù†Ø­Ø¨Ùƒ Ùˆ Ù†ÙƒÙˆØ¨ÙŠ ğŸ¥¹",
    "Ø³Ù‡Ø±Ø© ğŸ«£"
  ],

  songs: [
    {title:"Achkak historique ğŸ¥º", url:"https://youtu.be/jVvGerL-BZs?si=8hi0vp00xWlptfa_"},
    {title:"Mazal mazal ğŸ˜­", url:"https://youtu.be/N_fF3Ud5b6U?feature=shared"},
    {title:"Ù‚ØµØ© ØºØ±Ø§Ù… ğŸ’", url:"https://youtu.be/UkNhGq2GJ1s?si=arZazHfc6BYHVjoy", note:"ÙˆØ¹Ø¯ Ø±Ø§Ø­ ØªØ³Ù…Ø¹ÙŠÙ‡Ø§ ÙˆÙŠØ¯Ùƒ ÙÙŠ ÙŠØ¯ÙŠ ÙˆÙ†ØªÙŠ Ø¨ÙŠÙ† Ø­Ø¶Ø§Ù†ÙŠğŸ˜­ğŸ’"}
  ],

  letter: `Ù…Ø±ÙˆÙ‰ Ø¹ÙŠÙˆÙ†ÙŠ â¤ï¸
Ù…Ø§ Ù†Ø¹Ø±ÙØ´ Ù…Ù†ÙŠÙ† Ù†Ø¨Ø¯Ø£â€¦
Ù…Ù† Ø£ÙˆÙ„ Ù†Ù‡Ø§Ø± Ø´ÙØªÙƒ ÙÙŠÙ‡ØŸ
ÙˆÙ„Ø§ Ù…Ù† Ø£ÙˆÙ„ Ø¶Ø­ÙƒØ© Ø³Ø±Ù‚ØªÙŠÙ‡Ø§ Ù…Ù†ÙŠØŸ
ÙˆÙ„Ø§ Ù…Ù† Ø§Ù„Ù„Ø­Ø¸Ø© Ù„ÙŠ Ø­Ø³Ù‘ÙŠØª ÙÙŠÙ‡Ø§ Ø¨Ù„ÙŠ Ø­ÙŠØ§ØªÙŠ ØªØ¨Ø¯Ù„Ø§Øª ÙƒÙŠ Ø¯Ø®Ù„ØªÙŠÙ‡Ø§ØŸ

ØªØ¹Ø±ÙÙŠ ÙˆØ´ Ø±Ø§Ù‡ ØµØ§Ø±ÙŠÙ„ÙŠ Ù…Ø¹Ø§ÙƒØŸ
Ø±Ø§ÙƒÙ ÙˆÙ„ÙŠØªÙŠ Ø§Ù„Ø·Ù…Ø£Ù†ÙŠÙ†Ø© ØªØ§Ø¹ÙŠØŒ Ø§Ù„Ø±Ø§Ø­Ø© ØªØ§Ø¹ÙŠØŒ ÙˆØ§Ù„Ø­Ø§Ø¬Ø© Ø§Ù„ÙˆØ­ÙŠØ¯Ø© Ù„ÙŠ ÙƒÙŠ Ù†Ø®Ù…Ù… ÙÙŠÙ‡Ø§ Ù†Ø¨ØªØ³Ù… Ø¨Ù„Ø§ Ù…Ø§ Ù†Ø­Ø³ ğŸ¤

Ø±ØºÙ… Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† ØªÙ„Ù…Ø³Ø§Ù† ÙˆØ¨Ø§ØªÙ†Ø©â€¦
Ø¹Ù…Ø±ÙŠ Ù…Ø§ Ø­Ø³Ù‘ÙŠØªÙƒ Ø¨Ø¹ÙŠØ¯Ø©.
Ø¹Ù„Ù‰ Ø§Ù„Ø¹ÙƒØ³ØŒ ÙƒÙ„ ÙŠÙˆÙ… Ù†Ù‚Ø±Ø¨Ù„Ùƒ Ø£ÙƒØ«Ø± Ø¨Ø§Ù„Ù‚Ù„Ø¨ØŒ Ø¨Ø§Ù„ÙƒÙ„Ø§Ù…ØŒ Ø¨Ø§Ù„Ø¯Ø¹Ø§Ø¡â€¦

ÙˆÙƒÙ„ Ø«Ø§Ù†ÙŠØ© ØªÙÙˆØª Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙÙŠ Ù‡Ø°ÙŠ Ø§Ù„ØµÙØ­Ø© Ø±Ø§Ù‡ÙŠ ØªØ«Ø¨ØªÙ„ÙŠ Ø¨Ù„ÙŠ ÙˆØ¬ÙˆØ¯Ùƒ ÙÙŠ Ø­ÙŠØ§ØªÙŠ Ù†Ø¹Ù…Ø© ÙƒØ¨ÙŠØ±Ø© ğŸ¥¹âœ¨

Ù†Ø­Ø¨Ùƒ Ù…Ø´ÙŠ ØºÙŠØ± Ø¹Ù„Ù‰ Ø¬Ø§Ù„Ùƒ Ø¬Ù…ÙŠÙ„Ø©ØŒ
ÙˆÙ„Ø§ Ø¹Ù„Ù‰ Ø¬Ø§Ù„Ùƒ ØªØ¶Ø­ÙƒÙŠ ÙˆØªØ¶Ø­ÙƒÙŠÙ†ÙŠØŒ
Ù†Ø­Ø¨Ùƒ Ø¹Ù„Ù‰ Ø¬Ø§Ù„Ùƒ Ø£Ù†ØªÙŠ Ù…Ø±ÙˆÙ‰â€¦ Ø¨Ø·Ø¨Ø¹ÙƒØŒ Ø¨Ø±ÙˆØ­ÙƒØŒ Ø¨Ù‚Ù„Ø¨Ùƒ Ù„ÙŠ Ø£Ø­Ù† Ù…Ù† Ø§Ù„Ø¯Ù†ÙŠØ§ ÙƒØ§Ù…Ù„ ğŸ’

ÙƒÙŠ Ù†Ø®Ù…Ù… ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„â€¦
Ù†Ù„Ù‚Ø§Ùƒ Ø¯Ø§ÙŠÙ…Ù‹Ø§ ÙÙŠÙ‡.
ÙÙŠ Ø£Ø­Ù„Ø§Ù…ÙŠØŒ ÙÙŠ Ù†Ø¬Ø§Ø­Ø§ØªÙŠØŒ ÙÙŠ ØªØ¹Ø¨ÙŠØŒ ÙÙŠ ÙØ±Ø­ØªÙŠâ€¦
Ù†Ù„Ù‚Ø§Ùƒ Ø¯Ø§ÙŠÙ…Ù‹Ø§ Ø¬Ù†Ø¨ÙŠØŒ ÙˆÙŠØ¯ÙŠ ÙÙŠ ÙŠØ¯Ùƒ ÙƒÙŠÙ…Ø§ ÙˆØ¹Ø¯ØªÙƒ ğŸ’ğŸ¤

ÙˆØ¥Ø°Ø§ ÙƒØ§Ù† Ø¹Ù†Ø¯ÙŠ Ø£Ù…Ù†ÙŠØ© ÙˆØ­Ø¯Ø© Ù†Ø·Ù„Ø¨Ù‡Ø§ØŒ
Ù‡ÙŠ Ù†Ø¨Ù‚Ù‰ Ø¯Ø§ÙŠÙ…Ù‹Ø§ Ø§Ù„Ø´Ø®Øµ Ù„ÙŠ ÙŠØ®Ù„ÙŠÙƒ ØªØ¨ØªØ³Ù…ÙŠØŒ
ÙˆÙ†ÙƒÙˆÙ† Ø§Ù„Ø£Ù…Ø§Ù† Ù„ÙŠ ØªØ±Ø¬Ø¹ÙŠ Ù„Ù‡ ÙƒÙŠ ØªØªØ¹Ø¨ÙŠØŒ
ÙˆØ§Ù„Ù‚Ù„Ø¨ Ù„ÙŠ ÙŠØ­Ø¨Ùƒ Ø¨ØµØ­ ÙˆÙ…Ø§ ÙŠØªØ¨Ø¯Ù„Ø´ Ù…Ù‡Ù…Ø§ ØµØ±Ø§ ğŸ’˜

Ø´ÙƒØ±Ø§Ù‹ Ù„Ø£Ù†Ùƒ Ø¯Ø®Ù„ØªÙŠ Ø­ÙŠØ§ØªÙŠ ÙˆØ®Ù„ÙŠØªÙŠÙ‡Ø§ Ø£Ø¬Ù…Ù„.
ÙˆØ´ÙƒØ±Ø§Ù‹ Ù„Ø£Ù†Ùƒ Ø§Ø®ØªØ±ØªÙŠÙ†ÙŠ Ù†ÙƒÙˆÙ† Ø£Ù†Ø§â€¦

ÙˆØ¹Ø¯ Ù…Ù†ÙŠØŒ Ù…Ù‡Ù…Ø§ ØªØ¯ÙˆØ± Ø§Ù„Ø£ÙŠØ§Ù…ØŒ
ÙŠØ¨Ù‚Ù‰ Ø­Ø¨ÙŠ Ù„ÙŠÙƒ Ø«Ø§Ø¨ØªØŒ ÙŠÙƒØ¨Ø± ÙƒÙ„ ÙŠÙˆÙ…ØŒ
ÙƒÙŠÙ…Ø§ ÙŠÙƒØ¨Ø± Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ù„ÙŠ Ø­Ø§Ø·ÙŠÙ†Ùˆ Ù‡Ù†Ø§ â¤ï¸âœ¨

Ù†Ø­Ø¨Ùƒ Ø£ÙƒØ«Ø± Ù…Ù…Ø§ ØªÙ‚Ø¯Ø± Ø§Ù„ÙƒÙ„Ù…Ø§Øª ØªÙˆØµÙâ€¦
ÙˆØ£ÙƒØ«Ø± Ù…Ù…Ø§ ØªÙ‚Ø¯Ø± Ø§Ù„Ù…Ø³Ø§ÙØ§Øª ØªØ¨Ø¹Ø¯ ğŸ’Œ
â€” ÙˆØ§Ø¦Ù„ ğŸ’`
};

/* =========================
   ğŸ”’ LOCK LOGIC
   ========================= */
const lock = document.getElementById("lock");
const content = document.getElementById("content");
const pass = document.getElementById("pass");
const enter = document.getElementById("enter");
const lockCard = document.getElementById("lockCard");

function norm(s){ return (s||"").trim(); }

function unlock(){
  lock.style.display = "none";
  content.style.display = "block";
  popHearts();
}

function tryPass(){
  if(norm(pass.value) === PASSWORD){
    // âœ… Ø§Ø­ÙØ¸ Ø¨Ø§Ø´ Ù…Ø§ ØªØ¹Ø§ÙˆØ¯Ø´ ØªÙƒØªØ¨Ù‡Ø§
    try{ localStorage.setItem("love_lock_ok","1"); }catch(e){}
    unlock();
  } else {
    lockCard.classList.remove("shake"); void lockCard.offsetWidth;
    lockCard.classList.add("shake");
    popHearts(); // Ø­ØªÙ‰ Ø§Ù„ØºÙ„Ø· Ù†Ø®Ù„ÙˆÙ‡ Ù„Ø·ÙŠÙ ğŸ˜„
    alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙ„Ø· ÙŠØ§ Ø¹ÙŠÙˆÙ†ÙŠâ€¦ Ø¬Ø±Ù‘Ø¨ÙŠ Ø«Ø§Ù†ÙŠ ğŸ’—");
    pass.focus();
  }
}

enter.addEventListener("click", tryPass);
pass.addEventListener("keydown", (e)=>{ if(e.key==="Enter") tryPass(); });

// auto unlock if already ok
try{
  if(localStorage.getItem("love_lock_ok")==="1") unlock();
}catch(e){}

/* hearts background for lock */
const lockHearts = document.getElementById("lockHearts");
(function genHearts(){
  const emojis = ["â¤ï¸","ğŸ’–","ğŸ’˜","ğŸ’—","ğŸ’•"];
  for(let i=0;i<36;i++){
    const d=document.createElement("div");
    d.className="h";
    d.textContent = emojis[Math.floor(Math.random()*emojis.length)];
    d.style.left = (Math.random()*100)+"vw";
    d.style.animationDuration = (7+Math.random()*9)+"s";
    d.style.animationDelay = (-Math.random()*10)+"s";
    d.style.fontSize = (16+Math.random()*22)+"px";
    lockHearts.appendChild(d);
  }
})();

/* =========================
   Confetti hearts
   ========================= */
const confetti = document.getElementById("confetti");
function popHearts(){
  const emojis = ["â¤ï¸","ğŸ’–","ğŸ’˜"];
  const count = 90;
  for(let i=0;i<count;i++){
    const s=document.createElement("div");
    s.className="c";
    s.textContent = emojis[Math.floor(Math.random()*emojis.length)];
    s.style.left = (Math.random()*100) + "vw";
    s.style.top  = "-30px";
    s.style.opacity = (0.65 + Math.random()*0.35).toFixed(2);
    const dur = 1800 + Math.random()*1600;
    const dx  = (Math.random()*2-1)*160;
    const rot = (Math.random()*2-1)*720;
    confetti.appendChild(s);

    const start = performance.now();
    function anim(t){
      const p = Math.min(1, (t-start)/dur);
      const y = p*(window.innerHeight + 80);
      const x = dx*Math.sin(p*3.1416);
      s.style.transform = `translate(${x}px, ${y}px) rotate(${p*rot}deg)`;
      if(p<1) requestAnimationFrame(anim);
      else s.remove();
    }
    requestAnimationFrame(anim);
  }
}

/* Buttons */
document.getElementById("partyBtn").addEventListener("click", popHearts);

/* Copy link */
document.getElementById("copyBtn").addEventListener("click", async ()=>{
  try{ await navigator.clipboard.writeText(location.href); alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· âœ…"); }
  catch(e){ alert("Ù…Ø§ Ù‚Ø¯Ø±Ù†Ø§Ø´ Ù†Ù†Ø³Ø®Ùˆâ€¦ Ø§Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠ."); }
});

/* =========================
   Timer
   ========================= */
document.getElementById("sinceLabel").textContent = CONFIG.sinceDate;

const dDays=document.getElementById("dDays");
const dHours=document.getElementById("dHours");
const dMins=document.getElementById("dMins");
const dSecs=document.getElementById("dSecs");

function tick(){
  const start = new Date(CONFIG.sinceDate + "T00:00:00");
  const now = new Date();
  let diff = Math.max(0, now - start);

  const days = Math.floor(diff / (1000*60*60*24)); diff -= days*(1000*60*60*24);
  const hours = Math.floor(diff / (1000*60*60)); diff -= hours*(1000*60*60);
  const mins = Math.floor(diff / (1000*60)); diff -= mins*(1000*60);
  const secs = Math.floor(diff / 1000);

  dDays.textContent = days;
  dHours.textContent = hours;
  dMins.textContent = mins;
  dSecs.textContent = secs;
}
setInterval(tick,1000); tick();

/* =========================
   Love items render
   ========================= */
const loveGrid = document.getElementById("loveGrid");
CONFIG.loveItems.forEach(it=>{
  const div=document.createElement("div");
  div.className="loveItem";
  div.innerHTML = `
    <div class="loveEmoji">${it.emoji}</div>
    <div class="loveText"><b>${it.title}</b></div>
  `;
  loveGrid.appendChild(div);
});

/* =========================
   Songs render
   ========================= */
const songs = document.getElementById("songs");
CONFIG.songs.forEach(s=>{
  const a=document.createElement("a");
  a.href=s.url; a.target="_blank"; a.rel="noreferrer";
  a.innerHTML = `
    <div>
      <b>${s.title}</b><br>
      <small>${s.note ? s.note : "YouTube"}</small>
    </div>
    <span>â–¶ï¸</span>
  `;
  songs.appendChild(a);
});

/* =========================
   Compatibility (101%)
   ========================= */
function score101(a,b){
  let sum=0;
  const x=(a+b).trim();
  for(let i=0;i<x.length;i++) sum += x.charCodeAt(i)*(i+1);
  return 101 + (sum % 10);
}
document.getElementById("calcBtn").addEventListener("click", ()=>{
  const a=document.getElementById("name1").value || "Ø£Ù†Ø§";
  const b=document.getElementById("name2").value || "Ø§Ù†ØªÙŠ";
  const s=score101(a,b);
  document.getElementById("score").textContent = s;
  document.getElementById("scoreMsg").textContent =
    `âœ¨ ${a} Ùˆ ${b}: Ù†ØªÙŠØ¬ØªÙƒÙ… ${s}% â€” Ù‡Ø°ÙŠ Ù…Ø§Ø´ÙŠ Ø¹Ù„Ø§Ù‚Ø©â€¦ Ù‡Ø°ÙŠ â€œÙ‚Ø¯Ø±â€ ğŸ˜„â¤ï¸`;
});

/* =========================
   Envelope
   ========================= */
document.getElementById("letterText").textContent = CONFIG.letter;
const envBody = document.getElementById("envBody");
document.getElementById("envelope").addEventListener("click", ()=>{
  envBody.classList.toggle("open");
});
document.getElementById("copyLetter").addEventListener("click", async ()=>{
  try{ await navigator.clipboard.writeText(CONFIG.letter); alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø© âœ…"); }
  catch(e){ alert("Ù…Ø§ Ù‚Ø¯Ø±Ù†Ø§Ø´ Ù†Ù†Ø³Ø®Ùˆ."); }
});

/* =========================
   Scratch
   ========================= */
const canvas = document.getElementById("scratch");
const ctx = canvas.getContext("2d");
let scratching=false;

function resizeCanvas(){
  const rect = canvas.getBoundingClientRect();
  canvas.width = Math.floor(rect.width * devicePixelRatio);
  canvas.height= Math.floor(rect.height* devicePixelRatio);

  ctx.save();
  ctx.scale(devicePixelRatio, devicePixelRatio);
  const w = rect.width, h = rect.height;

  const g = ctx.createLinearGradient(0,0,w,h);
  g.addColorStop(0,"#ffe2f0");
  g.addColorStop(1,"#ffffff");
  ctx.globalCompositeOperation = "source-over";
  ctx.fillStyle = g;
  ctx.fillRect(0,0,w,h);

  ctx.fillStyle = "rgba(255,47,136,.20)";
  ctx.fillRect(0,0,w,h);

  ctx.fillStyle = "rgba(0,0,0,.65)";
  ctx.font = "700 18px system-ui";
  ctx.textAlign = "center";
  ctx.fillText("Ø§Ù…Ø³Ø­ÙŠ Ù‡Ù†Ø§ ğŸ’—", w/2, h/2);

  ctx.restore();
}
window.addEventListener("resize", resizeCanvas);
setTimeout(resizeCanvas, 200);

function getPos(e){
  const r = canvas.getBoundingClientRect();
  const x = (e.touches ? e.touches[0].clientX : e.clientX) - r.left;
  const y = (e.touches ? e.touches[0].clientY : e.clientY) - r.top;
  return {x,y};
}
function scratchAt(x,y){
  ctx.save();
  ctx.scale(devicePixelRatio, devicePixelRatio);
  ctx.globalCompositeOperation = "destination-out";
  ctx.beginPath();
  ctx.arc(x,y,26,0,Math.PI*2);
  ctx.fill();
  ctx.restore();
}
function start(e){ scratching=true; const p=getPos(e); scratchAt(p.x,p.y); }
function move(e){ if(!scratching) return; e.preventDefault(); const p=getPos(e); scratchAt(p.x,p.y); }
function end(){ scratching=false; }

canvas.addEventListener("mousedown", start);
canvas.addEventListener("mousemove", move);
window.addEventListener("mouseup", end);
canvas.addEventListener("touchstart", start, {passive:false});
canvas.addEventListener("touchmove", move, {passive:false});
canvas.addEventListener("touchend", end);

/* =========================
   Moon phase (approx)
   ========================= */
function moonPhase(dateStr){
  const date = new Date(dateStr + "T00:00:00Z");
  const knownNewMoon = new Date(Date.UTC(2000,0,6,18,14,0));
  const synodic = 29.530588853;
  const days = (date - knownNewMoon) / 86400000;
  let phase = (days % synodic) / synodic;
  if(phase < 0) phase += 1;

  const illum = (1 - Math.cos(2*Math.PI*phase)) / 2;
  const pct = Math.round(illum*100);

  let name = "â€”";
  if(phase < 0.03 || phase > 0.97) name="Ø­Ø¨ ÙƒØ§Ù…Ù„ ğŸŒ‘â¤ï¸";
else if(phase < 0.22) name="Ø¨Ø¯Ø§ÙŠØ© Ù‚ØµØ© âœ¨";
else if(phase < 0.28) name="Ø£ÙˆÙ„ ÙˆØ¹Ø¯ ğŸ¤";
else if(phase < 0.47) name="Ø­Ø¨ ÙŠÙƒØ¨Ø± ÙŠÙˆÙ… Ø¨Ø¹Ø¯ ÙŠÙˆÙ… ğŸ’•";
else if(phase < 0.53) name="Ù‚Ù…Ø± Ù…ÙƒØªÙ…Ù„ ÙƒÙŠ Ø­Ø¨Ù†Ø§ ğŸŒ•â¤ï¸";
else if(phase < 0.72) name="Ø´ÙˆÙ‚ ÙŠØ²ÙŠØ¯ ğŸŒ™";
else if(phase < 0.78) name="Ø­Ù†ÙŠÙ† Ø¯Ø§ÙØ¦ ğŸ’";
else name="Ø§Ø´ØªÙŠØ§Ù‚ Ø®ÙÙŠÙ ğŸ¤";
  return {phase, pct, name};
}
const mp = moonPhase(CONFIG.moonDate);
document.getElementById("moonName").textContent = "Ù‚Ù…Ø±Ù†Ø§ Ø§Ù„ÙŠÙˆÙ…: " + mp.name + " ğŸŒ™âœ¨";
document.getElementById("moonPct").textContent = "Ù†Ø³Ø¨Ø© Ø§Ù„Ù†ÙˆØ± Ø¨ÙŠÙ†Ø§ØªÙ†Ø§: " + mp.pct + "% ğŸ’";
const shadow = document.getElementById("moonShadow");
const shift = (mp.phase <= 0.5) ? (30 - mp.phase*60) : (-30 + (mp.phase-0.5)*60);
shadow.style.transform = `translateX(${shift}px)`;
  document.querySelector(".small").textContent =
"Ø­ØªÙ‰ Ø§Ù„Ù‚Ù…Ø± ÙŠØ´Ù‡Ø¯ Ø¨Ù„ÙŠ Ø­Ø¨Ù†Ø§ ÙŠÙƒØ¨Ø± ÙƒÙ„ Ù„ÙŠÙ„Ø© Ø£ÙƒØ«Ø± ğŸ’–";
  
/* =========================
   Prize wheel
   ========================= */
const wheel = document.getElementById("wheel");
const wctx = wheel.getContext("2d");
const prizes = CONFIG.prizes.slice();
let currentAngle = 0;
let spinning = false;

function drawWheel(){
  const N = prizes.length;
  const cx = wheel.width/2, cy = wheel.height/2;
  const R = wheel.width*0.44;

  wctx.clearRect(0,0,wheel.width,wheel.height);

  wctx.save();
  wctx.translate(cx,cy);
  wctx.rotate(currentAngle);

  for(let i=0;i<N;i++){
    const a0 = (i*2*Math.PI)/N;
    const a1 = ((i+1)*2*Math.PI)/N;
    const hue = (i*360/N);

    wctx.beginPath();
    wctx.moveTo(0,0);
    wctx.arc(0,0,R,a0,a1);
    wctx.closePath();
    wctx.fillStyle = `hsl(${hue}, 85%, 70%)`;
    wctx.fill();
    wctx.strokeStyle = "rgba(0,0,0,.08)";
    wctx.lineWidth = 6;
    wctx.stroke();

    wctx.save();
    wctx.rotate((a0+a1)/2);
    wctx.textAlign="right";
    wctx.fillStyle="#1a1a1a";
    wctx.font="700 28px system-ui";
    const txt = prizes[i];
    wctx.fillText(txt.length>22 ? (txt.slice(0,22)+"â€¦") : txt, R-18, 10);
    wctx.restore();
  }

  wctx.beginPath();
  wctx.arc(0,0,78,0,Math.PI*2);
  wctx.fillStyle = "#fff";
  wctx.fill();
  wctx.strokeStyle="rgba(0,0,0,.10)";
  wctx.lineWidth=6;
  wctx.stroke();

  wctx.fillStyle = "#ff2f88";
  wctx.font = "900 30px system-ui";
  wctx.textAlign="center";
  wctx.fillText("ğŸ", 0, 10);

  wctx.restore();
}
drawWheel();

function pickPrize(){
  const N=prizes.length;
  const normalized = (2*Math.PI - ((currentAngle + Math.PI/2) % (2*Math.PI))) % (2*Math.PI);
  const idx = Math.floor(normalized / (2*Math.PI/N));
  return prizes[idx];
}

document.getElementById("spinBtn").addEventListener("click", ()=>{
  if(spinning) return;
  spinning=true;
  document.getElementById("wheelResult").textContent="... ØªØ¯ÙˆÙ‘Ø± ğŸ¡";

  const extra = 10 + Math.random()*8;
  const target = currentAngle + extra*2*Math.PI + Math.random()*2*Math.PI;
  const start = performance.now();
  const dur = 4200;

  function anim(now){
    const p = Math.min(1,(now-start)/dur);
    currentAngle = currentAngle + (target-currentAngle)*0.08;
    const a = (currentAngle*(1-p)) + (target*p);
    currentAngle = a;

    drawWheel();

    if(p<1) requestAnimationFrame(anim);
    else{
      spinning=false;
      currentAngle = target;
      drawWheel();
      const win = pickPrize();
      document.getElementById("wheelResult").textContent = "Ø±Ø¨Ø­ØªÙŠ: " + win;
      popHearts();
    }
  }
  requestAnimationFrame(anim);
});
</script>
</body>
</html>
